---
aliases: 
created: '[[2025-09-24]]'
🤔: 
in: 
up: 
related: 
author:
---
# 🌲 Evergreen Note
```

```



---
# ✍️ Summary
-　


- ## ref
	- 📒：
	- link：
- ## Logs
	- [[2025-09-24]]
- ## todo
	- [ ] 
---
# 📒 Note
太好了！下面给你一段“可直接放进论文的方法比较”+“公式与适用场景”+“R实现指引”。读完就能把你现在的 **20 日滚动标准差** 方法和主流替代方案（Parkinson、Garman–Klass、Rogers–Satchell、Yang–Zhang、Realized Volatility、GARCH 家族）放在一起，清晰交代“为什么选它、它的边界、如果需要更强的稳健性与精细度该如何升级”。

---

# **1) 可直接放进论文的表述（方法小节模板）**

  

> **波动率度量**

> 基准方案采用**滚动窗口样本标准差**（rolling standard deviation, 20 日窗口）度量收益的条件波动性：在每一时点 t，用过去 n=20 个交易日收益率的样本标准差作为 \sigma_t。该方法计算简洁、对数据要求低（仅需收盘价生成的收益率），能刻画波动的时变特征，广泛用于实证研究的基线度量。

>   

> 为进行稳健性检验与方法对照，本文同时考虑了若干利用高低开收（OHLC）或更高频数据的信息增强估计量：

> （i）**Parkinson (1980)**：利用日内最高价与最低价估计波动，较收盘-收盘法效率更高，但忽略开收与方向性；

> （ii）**Garman–Klass (1980)**：在无漂移假设下综合高低开收，进一步提升效率；

> （iii）**Rogers–Satchell (1991)**：对漂移鲁棒，适用于存在明显趋势的资产；

> （iv）**Yang–Zhang (2000)**：综合隔夜波动、开盘跳跃与日内波动，通常被认为是对日内与隔夜都较稳健的日频波动估计；

> （v）**Realized Volatility（RV）**：在高频（如 5 分钟）下将日内平方收益求和，刻画非参数意义下的“实现波动”，并可配合去噪（如 subsampling 或 realized kernels）减轻微观结构噪声；

> （vi）**GARCH 家族（Engle, 1982；Bollerslev, 1986）**：通过条件异方差模型对 \sigma_t^2 的动态演化建模，能拟合“集群性、厚尾、杠杆效应”等统计特征，并支持预测与情景分析。

>   

> 经验上，我们将滚动标准差作为基准指标，并报告基于 Yang–Zhang 与 RV 的稳健性结果；在需要预测或检验结构性差异时，引入 GARCH(1,1)/EGARCH/GJR-GARCH 作为动态模型。日频波动率在跨标的可比时一律年化（以日频计 \sigma_{\text{ann}} = \sigma_{\text{day}} \sqrt{252}），并对估计窗口长度做敏感性分析（如 n \in \{10,20,60\}）。

  

> **你当前代码的精确表述**

> “我们使用 TTR::runSD 对日度收益序列计算 20 日滚动样本标准差，得到序列式的‘近一月’收盘-收盘波动率指标；随后将各行业指数（光伏设备、风电设备、电池、电网设备、煤炭、石油石化、AI）对应的滚动波动率对齐合并形成面板数据用于后续分析。”

---

# **2) 公式、直觉、优缺点与适用场景**

  

## **2.1 你现在使用的：滚动样本标准差（Close-to-Close）**

- **定义**（窗口 n=20，收益为 r_t）
    
    \sigma_t = \sqrt{\frac{1}{n-1}\sum_{i=0}^{n-1}\left(r_{t-i}-\bar r_t\right)^2},\quad \bar r_t=\frac{1}{n}\sum_{i=0}^{n-1} r_{t-i}.
    
- **优点**：实现简单、数据需求低（仅收盘价）、直观可解释；作为**基线**非常合适。
    
- **局限**：不利用日内极值/开收信息；对窗口选择较敏感；对结构性跳跃、隔夜跳空的表现有限。
    
- **何时用**：数据有限或做**基准度量**、横截面描述、快速风险指示。
    

  

## **2.2 Parkinson (1980) — 只用高低价的区间估计**

- **定义**：令 u_t=\ln(H_t/L_t)，则日方差估计
    
    \hat{\sigma}{\text{PK},t}^2 = \frac{1}{4\ln 2}\,u_t^2;\quad \text{或在窗口内取平均：}\; \hat{\sigma}^2=\frac{1}{m}\sum{t=1}^m \frac{(\ln(H_t/L_t))^2}{4\ln 2}.
    
- **优点**：利用日内振幅信息，相比收盘-收盘更高效率。
    
- **局限**：忽略开收信息与漂移；对跳空/隔夜不敏感。
    
- **何时用**：**只有 H/L** 可靠可用时的“增强版”日波动估计。
    

  

## **2.3 Garman–Klass (1980) — OHLC 组合（无漂移假设）**

- **日方差估计**（常见形式）：
    
    \hat{\sigma}_{\text{GK},t}^2 = 0.5\big(\ln(H_t/L_t)\big)^2 - (2\ln 2 -1)\big(\ln(C_t/O_t)\big)^2.
    
- **优点**：利用 OHLC，效率进一步提升。
    
- **局限**：**依赖“无漂移”假设**（存在趋势或大漂移时偏误）。
    
- **何时用**：趋势较弱、OHLC 完整可靠。
    

  

## **2.4 Rogers–Satchell (1991) — 对漂移鲁棒**

- **定义**：
    
    \hat{\sigma}_{\text{RS},t}^2 = \big(\ln(H_t/O_t)\big)\big(\ln(H_t/C_t)\big) • \big(\ln(L_t/O_t)\big)\big(\ln(L_t/C_t)\big).
    
    -   
        
        窗口内取平均可得期内方差。
        
    
- **优点**：**不依赖无漂移假设**，在有明显趋势/漂移时更稳健。
    
- **局限**：仍未显式处理隔夜跳空。
    
- **何时用**：存在趋势或漂移、仍使用日级 OHLC 的场景。
    

  

## **2.5 Yang–Zhang (2000) — 综合隔夜与日内，常用的“日频最强基线”**

- **构造思路**：将“隔夜（O_t/C_{t-1}）”、“开收（C_t/O_t）”与“RS 日内项”线性组合：
    
    \hat{\sigma}{\text{YZ}}^2 = \sigma_o^2 + k\,\sigma_c^2 + (1-k)\,\sigma{rs}^2,
    
    其中 \sigma_o^2 为隔夜收益方差，\sigma_c^2 为开收收益方差，\sigma_{rs}^2 为 RS 日内估计；k 为权重（常用 k=\tfrac{0.34}{1.34+\frac{n+1}{n-1}}）。
    
- **优点**：综合了**隔夜跳空**与**日内波动**，实践中常被认为是**日频 OHLC 的首选**。
    
- **局限**：依赖干净的 OHLC；参数 k 需要按样本长度设定。
    
- **何时用**：**日频**数据完整、需比 close-to-close 更稳健的主方法。
    

  

## **2.6 Realized Volatility（RV）— 利用高频数据的“实现波动”**

- **定义**（以日为单位，\Delta 为高频间隔，如 5 分钟）
    
    \text{RV}t = \sum{i=1}^{M} r_{t,i}^2,
    
    其中 r_{t,i} 为同日内高频对数收益。
    
- **优点**：在无噪理想条件下是一致估计；能分析昼夜分解、跳跃成分、协方差（实现协方差/相关）。
    
- **局限**：高频数据成本与清洗；**微观结构噪声**（报价离散、异步等）需要方法修正（如 subsampling、realized kernels、two-scale RV）。
    
- **何时用**：有高频数据、需要更精细的波动刻画或构造**波动-互联**网络、**因果/传染**研究。
    

  

## **2.7 GARCH 家族 — 可预测的条件方差动态**

- **基本 GARCH(1,1)**：
    
    r_t=\mu+\varepsilon_t,\quad \varepsilon_t=\sigma_t z_t,\quad \sigma_t^2=\omega+\alpha \varepsilon_{t-1}^2+\beta \sigma_{t-1}^2.
    
- **扩展**：EGARCH（对称/非对称、对数方差）、GJR-GARCH（杠杆效应）、t/ GED 分布（厚尾），以及多变量（DCC-GARCH）等。
    
- **优点**：可做**预测**与**情景**分析；拟合波动聚集与杠杆效应。
    
- **局限**：参数化假设；易受模型设定与分布假设影响；对极端跳跃/结构突变需外生项或 regime-switching。
    
- **何时用**：需要**预测/推断**、政策/事件评估、风控场景（如 VaR、ES）。
    

---

# **3) 如何在你的研究里“会用、用好”**

1. **作为主方法**
    

  

- 如果只有收盘价：保留 **20 日滚动标准差** 为基线，但务必**年化**、并做窗口敏感性（10/20/60）；
    
- 如果有 OHLC：优先报 **Yang–Zhang** 作为主文的“稳健主指标”，滚动标准差作为**对照**；
    
- 重点结论（例如行业间波动分层、互联强弱）建议同时在 **YZ 与 close-to-close** 下复现一次，写“稳健性一致”。
    

  

2. **作为稳健性/扩展**
    

  

- **Parkinson / GK / RS**：附录或稳健性表，说明“利用日内极值/开收信息，结论不变”；
    
- **RV（高频）**：若你后续需要做**时变联动/溢出网络（Diebold–Yilmaz 类）或跳跃分解**，强烈建议引入（哪怕是样本子区间）。
    
- **GARCH**：当你需要**预测下一期/下一月波动**，或解释“波动聚类与不对称效应”时，用 GARCH 家族给出**参数化证据**，与非参的滚动/实现波动相互补充。
    

  

3. **年化、对齐与对比**
    

  

- 统一把日波动率乘 \sqrt{252} 年化；周、月频需对应 \sqrt{52} 或 \sqrt{12}；
    
- 多行业合并面板时，**对齐交易日与缺失值处理**（你代码里 na.omit 已做首端 NA 剪裁，保持即可）；
    
- 在图表里统一 y 轴“年化波动（%）”，便于横向比较。
    

---

# **4) R 代码速用（与你当前框架兼容）**

```
# 1) 你的基线（已实现）
# returns: xts，每列为一个行业的日收益
library(TTR)
vol_roll20 <- do.call(merge, lapply(returns, function(x) runSD(x, n = 20)))
vol_roll20 <- na.omit(vol_roll20) * sqrt(252)  # 年化

# 2) Yang–Zhang（TTR 自带多种估计）
# 需要 OHLC 的 xts：列名为 Open/High/Low/Close
# 假设 mkt 是一个包含四列的 xts
vol_yz <- TTR::volatility(mkt, calc = "yang.zhang", n = 20) * sqrt(252)

# 其它：parkinson / garman / rogers
vol_pk <- TTR::volatility(mkt, calc = "parkinson", n = 20) * sqrt(252)
vol_gk <- TTR::volatility(mkt, calc = "garman", n = 20) * sqrt(252)
vol_rs <- TTR::volatility(mkt, calc = "rogers.satchell", n = 20) * sqrt(252)

# 3) Realized Volatility（高频）
# 需高频数据，推荐 highfrequency 包
# install.packages("highfrequency")
# library(highfrequency)
# RV 典型用法：rCov/rKernel 等，或自己按 5min 返回求和

# 4) GARCH（rugarch）
# install.packages("rugarch")
library(rugarch)
spec <- ugarchspec(variance.model = list(model = "sGARCH", garchOrder = c(1,1)),
                   mean.model     = list(armaOrder = c(0,0)),
                   distribution.model = "std")
fit  <- ugarchfit(spec, data = returns[, "AI"])  # 单列收益
sigma_garch <- sigma(fit) * sqrt(252)  # 年化条件波动
```

---

# **5) 一句话指北：如何在论文里“摆得明白”**

- **方法段**：先给出你的**滚动标准差**定义与窗口（20 日），交代**年化**与面板对齐；
    
- **对照段**：说明引入 **Yang–Zhang**、**Parkinson/GK/RS** 与（若有高频）**RV** 做稳健性；
    
- **预测/机制段（可选）**：用 **GARCH** 捕捉聚类与杠杆、给出预测或事件响应；
    
- **结果段**：强调“多口径一致”，并在附录贴出不同估计口径下的关键图表/表格。
    

---

# **6) 经典参考文献（放在参考文献里就好）**

- Bollerslev, T. (1986). Generalized autoregressive conditional heteroskedasticity. _Journal of Econometrics, 31_(3), 307–327.
    
- Engle, R. F. (1982). Autoregressive conditional heteroskedasticity with estimates of the variance of U.K. inflation. _Econometrica, 50_(4), 987–1007.
    
- Garman, M. B., & Klass, M. J. (1980). On the estimation of security price volatilities from historical data. _Journal of Business, 53_(1), 67–78.
    
- Parkinson, M. (1980). The extreme value method for estimating the variance of the rate of return. _Journal of Business, 53_(1), 61–65.
    
- Rogers, L. C. G., & Satchell, S. E. (1991). Estimating variance from high, low and closing prices. _Annals of Applied Probability, 1_(4), 504–512.
    
- Yang, D., & Zhang, Q. (2000). Drift-independent volatility estimation based on high, low, open, and close prices. _Journal of Business, 73_(3), 477–492.
    
- Andersen, T. G., Bollerslev, T., Diebold, F. X., & Labys, P. (2003). Modeling and forecasting realized volatility. _Econometrica, 71_(2), 579–625.
    

  

> 如果你后续要把 **Diebold–Yilmaz** 的连通性或 **TVP-VAR** 和这些波动口径结合，我可以顺手给你出一版“不同波动率口径 → 方差分解的敏感性设计”，包括：频率匹配、滞后阶数一致性、滚动窗 vs. 递推估计的取舍，以及“隔夜跳空”是否进入创新项的处理方案。



