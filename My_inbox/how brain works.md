---
aliases: 
created: '[[2025-09-03]]'
ğŸ¤”: 
in: 
up: 
related: 
author:
---
# ğŸŒ² Evergreen Note
```
# noteçš„éƒ¨åˆ†æ˜¯æœ¬ç¯‡æ–‡ç« çš„åŸæ–‡
# summaryçš„éƒ¨åˆ†æ˜¯æˆ‘å¯¹äºåŸæ–‡éƒ¨åˆ†é‡ç‚¹çš„æå–ï¼Œä»¥åŠè‡ªå·±çš„æ€è€ƒï¼ˆç”¨ğŸ¤”æ¥ä»£è¡¨æˆ‘çš„æ€è€ƒï¼Œ**ã€*====* æ˜¯æˆ‘å¯¹é‡ç‚¹çš„ä¸¤ä¸ªå±‚çº§æ ‡è¯†ï¼‰

è¯·ä½ æ ¹æ®# noteå’Œ# summaryçš„éƒ¨åˆ†å¸®æˆ‘æ€»ç»“{activeNote}ï¼ŒæŒ‰â€œæ¦‚è¿°â€æ¨¡å¼è¾“å‡ºã€‚ 
> [!summary] æ¦‚è¿°  ï¼ˆè¦å†™å…·ä½“å†…å®¹ï¼Œç‚¹åˆ—æ ¼å¼ï¼Œæ’ç‰ˆç´§å‡‘ï¼‰
>  
>   
> **ä¸€å¥è¯**ï¼š 

```


ä¸€åªè‚¡ç¥¨è®°ä¸ºG æ˜¯ä¸€ä¸ªç°å®ä¸–ç•Œçš„å®ä½“ã€‚
G(X,Y,Z,...)

æˆ‘ä»¬è®°alpha=f(y,z,...)  æ˜¯è‚¡ç¥¨å…¶ä»–æŒ‡æ ‡çš„ä¸€ä¸ªå‡½æ•°

é‚£ä¹ˆalpha

```
> [!summary] æ¦‚è¿°
>
> *   **æ ¸å¿ƒç›®çš„**ï¼šè¯¦ç»†è§£é‡Š WorldQuant BRAIN å¹³å°å¦‚ä½•è¿ä½œï¼Œä»¥åŠæ¨¡æ‹Ÿ Alpha æ—¶åå°å‘ç”Ÿçš„æ­¥éª¤ï¼Œå¸®åŠ©ç”¨æˆ·åŸ¹å…»ç›´è§‰ï¼Œä¼˜åŒ– Alpha åˆ›å»ºè¿‡ç¨‹ã€‚
> *   **æ•°æ®ç»“æ„**ï¼šå°†å¸‚åœºæ•°æ®è§†ä¸ºä¸€ä¸ªçŸ©é˜µï¼Œå…¶ä¸­è¡Œä»£è¡¨æ—¥æœŸï¼Œåˆ—ä»£è¡¨è‚¡ç¥¨ï¼Œä¾‹å¦‚ US TOP3000 è‚¡ç¥¨çš„æ”¶ç›˜ä»·æ•°æ®ã€‚
> *   **æ¨¡æ‹Ÿè¿‡ç¨‹**ï¼š
> 	*   å¹³å°é’ˆå¯¹äº”å¹´è·¨åº¦å†…çš„æ¯ä¸ªæ—¥æœŸï¼Œå¯¹å¸‚åœºæ•°æ®çŸ©é˜µè¯„ä¼° Alpha è¡¨è¾¾å¼ã€‚
> 	*   ä¸ºæ¯ä¸ªé‡‘èå·¥å…·æŒæœ‰å¤šå¤´æˆ–ç©ºå¤´å¤´å¯¸ï¼Œä»è€Œç”Ÿæˆ PnL å›¾è¡¨ã€‚
> *   **ä¸ƒä¸ªæ­¥éª¤**ï¼š
> 	*   **æ­¥éª¤ 1**ï¼šè¯„ä¼°è¡¨è¾¾å¼ï¼Œç”Ÿæˆ Alpha å‘é‡ã€‚
> 	*   **æ­¥éª¤ 2**ï¼šä¸­æ€§åŒ–ï¼Œä»å‘é‡ä¸­çš„æ¯ä¸ªå€¼å‡å»è¯¥ç»„å‘é‡å€¼çš„å¹³å‡å€¼ï¼Œä½¿æ‰€æœ‰å‘é‡å€¼çš„æ€»å’Œä¸º 0ã€‚
> 	*   **æ­¥éª¤ 3**ï¼šæ ‡å‡†åŒ–ï¼Œç¼©æ”¾å‘é‡å€¼ï¼Œä½¿ç»å¯¹å€¼æ€»å’Œä¸º 1ï¼Œå¾—åˆ°æ ‡å‡†åŒ–æƒé‡ã€‚
> 	*   **æ­¥éª¤ 4**ï¼šèµ„é‡‘åˆ†é…ï¼Œä½¿ç”¨æ ‡å‡†åŒ–æƒé‡ï¼Œå°† 2000 ä¸‡ç¾å…ƒçš„è™šæ‹Ÿèµ„é‡‘åˆ†é…ç»™æ¯åªè‚¡ç¥¨ã€‚
> 	*   **æ­¥éª¤ 5**ï¼šè®¡ç®—æ¬¡æ—¥ PnLï¼Œæ ¹æ®è‚¡ç¥¨å›æŠ¥è®¡ç®— Alpha äº§ç”Ÿçš„ PnLã€‚
> 	*   **æ­¥éª¤ 6**ï¼šé‡å¤æ­¥éª¤ 1-5ï¼Œè·å–æ ·æœ¬å†…æœŸé—´ (IS) çš„æ¯æ—¥ PnLã€‚
> 	*   **æ­¥éª¤ 7**ï¼šè®¡ç®—ç´¯ç§¯ PnLï¼Œç”Ÿæˆ Alpha çš„ PnL å›¾è¡¨ã€‚
> *   **å¤šç©ºå¸‚åœºä¸­æ€§åŒ–**ï¼šé€šè¿‡å¤šç©ºä»“ä½ï¼Œç­–ç•¥åœ¨å¸‚åœºä¸åŒæ–¹å‘éƒ½æœ‰ç›ˆåˆ©æ½œåŠ›ã€‚
> *   **Alpha æƒé‡**ï¼šAlpha æƒé‡æ˜¯åˆ†é…ç»™æ¯åªè‚¡ç¥¨çš„æƒé‡ä½ç½®ï¼Œä¹˜ä»¥è´¦é¢è§„æ¨¡å¾—åˆ°ç¾å…ƒä»·å€¼ã€‚
> *   **æ¢æ‰‹ç‡**ï¼šæ¯æ—¥äº¤æ˜“çš„æŠ•èµ„ç»„åˆç™¾åˆ†æ¯”ï¼Œæ¨¡æ‹Ÿç»“æœä¸­æŠ¥å‘Šçš„æ˜¯å¹³å‡æ—¥æ¢æ‰‹ç‡ã€‚
> *   **è¡°å‡ (Decay)**ï¼šå¼•å…¥è¡°å‡åï¼ŒAlpha çš„æƒé‡ç»“åˆäº†å½“æ—¥å€¼å’Œå‰å‡ æ—¥çš„è¡°å‡å€¼ï¼Œå‡å°‘äº¤æ˜“æˆæœ¬å’Œè¿‡åº¦ååº”ã€‚
> *   **æ ·æœ¬å†… (IS) å’Œæ ·æœ¬å¤– (OS) æœŸé—´**ï¼šæ¨¡æ‹Ÿå™¨è®¡ç®— IS æœŸé—´çš„ PnLï¼Œè€Œ OS æœŸé—´ç”¨äºè¯„ä¼° Alpha çš„ç¨³å¥æ€§ã€‚
>
> **ä¸€å¥è¯**ï¼šæœ¬æ–‡è¯¦ç»†è§£é‡Šäº† WorldQuant BRAIN å¹³å°æ¨¡æ‹Ÿ Alpha çš„ä¸ƒä¸ªæ­¥éª¤ï¼ŒåŒ…æ‹¬æ•°æ®å¤„ç†ã€ä¸­æ€§åŒ–ã€æ ‡å‡†åŒ–ã€èµ„é‡‘åˆ†é…ã€PnL è®¡ç®—ä»¥åŠè¡°å‡çš„åº”ç”¨ï¼Œæ—¨åœ¨å¸®åŠ©ç”¨æˆ·ç†è§£å¹³å°è¿ä½œæœºåˆ¶ï¼Œä»è€Œæ›´æœ‰æ•ˆåœ°åˆ›å»ºå’Œè¯„ä¼°é‡åŒ–äº¤æ˜“ç­–ç•¥ã€‚
```



---
# âœï¸ Summary
-ã€€


- ## ref
	- ğŸ“’ï¼š
	- linkï¼š
- ## Logs
	- [[2025-09-03]]
- ## to do
	- [ ] 
---
# ğŸ“’ Note


[

  
Simulate

](https://platform.worldquantbrain.com/simulate)[

Alphas

](https://platform.worldquantbrain.com/alphas/unsubmitted)[

Learn

](https://platform.worldquantbrain.com/learn)[

Data

](https://platform.worldquantbrain.com/data)

Competitions (1)

[

Team

](https://platform.worldquantbrain.com/team/active)[

Community

](https://support.worldquantbrain.com/hc/en-us/community/topics)[

Consultant program

](https://platform.worldquantbrain.com/consultant-program/)[

Refer a friend

](https://platform.worldquantbrain.com/referral)

Notifications

User menu

[CoursesÂ Â è¯¾ç¨‹](https://platform.worldquantbrain.com/learn/courses)[DocumentationÂ Â æ–‡æ¡£](https://platform.worldquantbrain.com/learn/documentation)[OperatorsÂ Â æ“ä½œå‘˜](https://platform.worldquantbrain.com/learn/operators)[FAQÂ Â å¸¸è§é—®é¢˜è§£ç­”](https://support.worldquantbrain.com/hc/en-us)[EventsÂ Â æ´»åŠ¨](https://platform.worldquantbrain.com/events/)[GlossaryÂ Â æœ¯è¯­è¡¨](https://support.worldquantbrain.com/hc/en-us/articles/4902349883927)

[DocumentationÂ Â æ–‡æ¡£](https://platform.worldquantbrain.com/learn/documentation)[Next: â­ Alpha Examples for BeginnersÂ Â ä¸‹ä¸€é¡µï¼šâ­ åˆå­¦è€…çš„ Alpha ç¤ºä¾‹](https://platform.worldquantbrain.com/learn/documentation/create-alphas/19-alpha-examples)

## â­ How BRAIN works

The below post illustrates in detail how the BRAIN platform works and what happens in the background when you simulate an Alpha. Even though youâ€™ll never need to do these calculations yourselves, developing an intuition for them will help you in the Alpha making process.  
ä¸‹é¢çš„å¸–å­è¯¦ç»†è¯´æ˜äº† BRAIN å¹³å°çš„å·¥ä½œåŸç†ï¼Œä»¥åŠå½“ä½ æ¨¡æ‹Ÿ Alpha æ—¶åå°ä¼šå‘ç”Ÿä»€ä¹ˆã€‚å³ä½¿ä½ æ°¸è¿œä¸éœ€è¦è‡ªå·±è¿›è¡Œè¿™äº›è®¡ç®—ï¼ŒåŸ¹å…»å¯¹å®ƒä»¬çš„ç›´è§‰ä¹Ÿå°†æœ‰åŠ©äºä½ åœ¨ Alpha åˆ¶ä½œè¿‡ç¨‹ä¸­ã€‚

Imagine market data being a matrix, with each row representing one date and each column representing one stock. For example, the matrix for close price data of stocks inÂ [universe](https://support.worldquantbrain.com/hc/en-us/articles/4902349883927-Click-here-for-a-list-of-terms-and-their-definitions#:~:text=U-,Universe,-Universe)Â US TOP3000 would look like this:  
æƒ³è±¡å¸‚åœºæ•°æ®æ˜¯ä¸€ä¸ªçŸ©é˜µï¼Œæ¯ä¸€è¡Œä»£è¡¨ä¸€ä¸ªæ—¥æœŸï¼Œæ¯ä¸€åˆ—ä»£è¡¨ä¸€åªè‚¡ç¥¨ã€‚ä¾‹å¦‚ï¼ŒUS TOP3000 è‚¡ç¥¨ç»„åˆçš„æ”¶ç›˜ä»·æ•°æ®çŸ©é˜µçœ‹èµ·æ¥æ˜¯è¿™æ ·çš„ï¼š

![1 table.png](https://api.worldquantbrain.com/content/images/290v4zN6dVd09ELH52-1BLCEtIg=/246/original/1_table.png)

When you input the simulation settings and click â€œSimulateâ€, the BRAIN platform will evaluate the Alpha expression against the matrix of market data for each date in a five year span, taking a long or short position for each financial instrument to generate the PnL chart.  
å½“ä½ è¾“å…¥æ¨¡æ‹Ÿè®¾ç½®å¹¶ç‚¹å‡»â€œæ¨¡æ‹Ÿâ€æ—¶ï¼ŒBRAIN å¹³å°å°†é’ˆå¯¹äº”å¹´è·¨åº¦å†…çš„æ¯ä¸ªæ—¥æœŸï¼Œå¯¹å¸‚åœºæ•°æ®çŸ©é˜µè¯„ä¼° Alpha è¡¨è¾¾å¼ï¼Œä¸ºæ¯ä¸ªé‡‘èå·¥å…·æŒæœ‰å¤šå¤´æˆ–ç©ºå¤´å¤´å¯¸ï¼Œä»è€Œç”Ÿæˆ PnL å›¾è¡¨ã€‚

![2_simulate_771x.png](https://api.worldquantbrain.com/content/images/NwdRXoZepImHCXsWwisSJipBYbQ=/259/original/2_simulate_771x.png)

Behind the scenes, seven steps, or operations, are performed before the final PnL chart is generated.  
åœ¨æœ€ç»ˆ PnL å›¾è¡¨ç”Ÿæˆä¹‹å‰ï¼Œåå°ä¼šæ‰§è¡Œä¸ƒä¸ªæ­¥éª¤æˆ–æ“ä½œã€‚

Normally, in an Alpha simulation, there would be between 200 and 3,000 stock instruments in the universe. But to better understand this concept, weâ€™ll assume a hypothetical scenario in which the simulation universe has only eight stocks. We simulate the expressionÂ **rank(-returns)**Â with market neutralization, Delay 1 and Decay 0 settings for now.  
é€šå¸¸æƒ…å†µä¸‹ï¼Œåœ¨ Alpha æ¨¡æ‹Ÿä¸­ï¼Œè‚¡ç¥¨æ± ä¸­ä¼šæœ‰ 200 åˆ° 3,000 ç§è‚¡ç¥¨å·¥å…·ã€‚ä½†ä¸ºäº†æ›´å¥½åœ°ç†è§£è¿™ä¸ªæ¦‚å¿µï¼Œæˆ‘ä»¬å°†å‡è®¾ä¸€ä¸ªæ¨¡æ‹Ÿåœºæ™¯ï¼Œå…¶ä¸­æ¨¡æ‹Ÿè‚¡ç¥¨æ± åªæœ‰å…«åªè‚¡ç¥¨ã€‚ç›®å‰æˆ‘ä»¬ä½¿ç”¨å¸‚åœºä¸­æ€§åŒ–ã€å»¶è¿Ÿ 1 å’Œè¡°å‡ 0 çš„è®¾ç½®æ¥æ¨¡æ‹Ÿè¡¨è¾¾å¼ rank(-returns)ã€‚

The hypothesis in this expression is that we want to buy, or go long on, those stocks tomorrow that had negative or comparatively lower returns today, and we want to sell, or go short on, those stocks tomorrow that had positive or comparatively higher returns today.  
è¿™ä¸ªè¡¨è¾¾å¼çš„å‡è®¾æ˜¯æˆ‘ä»¬å¸Œæœ›ä¹°å…¥æˆ–åšå¤šé‚£äº›ä»Šå¤©è¡¨ç°è´Ÿæˆ–ç›¸å¯¹è¾ƒä½æ”¶ç›Šçš„è‚¡ç¥¨ï¼ŒåŒæ—¶å–å‡ºæˆ–åšç©ºé‚£äº›ä»Šå¤©è¡¨ç°æ­£æˆ–ç›¸å¯¹è¾ƒé«˜æ”¶ç›Šçš„è‚¡ç¥¨ã€‚

Weâ€™ve used the rank operator, which ranks the input values inside the operator and return values equally distributed between zero and 1. This is an example of a reversion idea.  
æˆ‘ä»¬ä½¿ç”¨äº† rank è¿ç®—ç¬¦ï¼Œè¯¥è¿ç®—ç¬¦å¯¹è¿ç®—ç¬¦å†…çš„è¾“å…¥å€¼è¿›è¡Œæ’åºï¼Œå¹¶è¿”å›åœ¨ 0 å’Œ 1 ä¹‹é—´å‡åŒ€åˆ†å¸ƒçš„å€¼ã€‚è¿™æ˜¯ä¸€ä¸ªå›å½’æ€æƒ³çš„ä¾‹å­ã€‚

![3 table.png](https://api.worldquantbrain.com/content/images/21_y9-wzhl0hc08V2_q6iBlIGOg=/249/original/3_table.png)

In Column B, we have the eight stocks in the Alpha vector. Column C shows the returns of these stocks as of February 1st. These serve as the input data of the Alpha expression.  
åœ¨ B åˆ—ä¸­ï¼Œæˆ‘ä»¬æœ‰ Alpha å‘é‡ä¸­çš„å…«åªè‚¡ç¥¨ã€‚C åˆ—æ˜¾ç¤ºäº†è¿™äº›è‚¡ç¥¨åœ¨ 2 æœˆ 1 æ—¥çš„æ”¶ç›Šã€‚è¿™äº›æ˜¯ Alpha è¡¨è¾¾å¼çš„è¾“å…¥æ•°æ®ã€‚

**Step1:**Â Evaluate the expression for each stock to generate the Alpha vector for the given date.  
æ­¥éª¤ 1ï¼šå¯¹æ¯åªè‚¡ç¥¨è¯„ä¼°è¡¨è¾¾å¼ï¼Œä¸ºç»™å®šæ—¥æœŸç”Ÿæˆ Alpha å‘é‡ã€‚

In our case, this date would be February 2nd, because weâ€™ve assumed Delay 1 settings. The Delay 1 setting uses data as of T-1 date to create the Alpha vector as of T date.  
åœ¨æˆ‘ä»¬çš„æ¡ˆä¾‹ä¸­ï¼Œè¿™ä¸ªæ—¥æœŸæ˜¯ 2 æœˆ 2 æ—¥ï¼Œå› ä¸ºæˆ‘ä»¬å‡è®¾äº†å»¶è¿Ÿ 1 è®¾ç½®ã€‚å»¶è¿Ÿ 1 è®¾ç½®ä½¿ç”¨ T-1 æ—¥æœŸçš„æ•°æ®æ¥åˆ›å»º T æ—¥æœŸçš„ Alpha å‘é‡ã€‚

To produce the Alpha vector, the simulator performs the rank operation on negative returns and produces a vector of values corresponding to each stock.  
ä¸ºäº†ç”Ÿæˆ Alpha å‘é‡ï¼Œæ¨¡æ‹Ÿå™¨å¯¹è´Ÿå›æŠ¥æ‰§è¡Œæ’åæ“ä½œï¼Œå¹¶ç”Ÿæˆå¯¹åº”æ¯åªè‚¡ç¥¨çš„å€¼å‘é‡ã€‚

![4 table.png](https://api.worldquantbrain.com/content/images/XpIzC8CMeVY_hhMY01UeksNeu6g=/250/original/4_table.png)

The resulting vector depends on the operators used in the Alpha expression. In our case, since weâ€™ve used the rank operator, we see equally distributed values between 0 and 1 in Column D. Note that the stock with the lowest return has the highest value, and vice versa, in line with our hypothesis.  
ç»“æœå‘é‡å–å†³äº Alpha è¡¨è¾¾å¼ä¸­ä½¿ç”¨çš„æ“ä½œç¬¦ã€‚åœ¨æˆ‘ä»¬çš„æ¡ˆä¾‹ä¸­ï¼Œå› ä¸ºæˆ‘ä»¬ä½¿ç”¨äº†æ’åæ“ä½œç¬¦ï¼Œæ‰€ä»¥åœ¨ D åˆ—ä¸­çœ‹åˆ° 0 åˆ° 1 ä¹‹é—´å‡åŒ€åˆ†å¸ƒçš„å€¼ã€‚è¯·æ³¨æ„ï¼Œå›æŠ¥æœ€ä½çš„è‚¡ç¥¨å…·æœ‰æœ€é«˜å€¼ï¼Œåä¹‹äº¦ç„¶ï¼Œè¿™ä¸æˆ‘ä»¬çš„å‡è®¾ä¸€è‡´ã€‚

**_Step 2_**_: From each value in the vector, subtract the average of the vector values in the group. Sum of all vector values = 0._Â This is called neutralization.  
ç¬¬äºŒæ­¥ï¼šä»å‘é‡ä¸­çš„æ¯ä¸ªå€¼å‡å»è¯¥ç»„å‘é‡å€¼çš„å¹³å‡å€¼ã€‚æ‰€æœ‰å‘é‡å€¼çš„æ€»å’Œ=0ã€‚è¿™ç§°ä¸ºä¸­å’Œã€‚

The group can be the entire market, but we can also perform this neutralization operation on sector, industry or subindustry groupings of stocks.  
è¯¥ç»„å¯ä»¥æ˜¯æ•´ä¸ªå¸‚åœºï¼Œä½†æˆ‘ä»¬ä¹Ÿå¯ä»¥å¯¹è‚¡ç¥¨çš„è¡Œä¸šã€è¡Œä¸šæˆ–å­è¡Œä¸šåˆ†ç»„æ‰§è¡Œæ­¤ä¸­å’Œæ“ä½œã€‚

![5 table.png](https://api.worldquantbrain.com/content/images/bSCbjW3xSTCOReSxQDS9SANd-XA=/251/original/5_table.png)

Since we have only eight stocks in our simulation universe, weâ€™ve assumed to neutralize the stocks over the market.  
ç”±äºæˆ‘ä»¬çš„æ¨¡æ‹Ÿå®‡å®™ä¸­åªæœ‰å…«åªè‚¡ç¥¨ï¼Œæˆ‘ä»¬å‡è®¾å¯¹å¸‚åœºä¸­çš„è‚¡ç¥¨è¿›è¡Œä¸­å’Œã€‚

So we take the average of the numbers in Cell D12 and subtract the average from each stock. This gives us a new vector in Column F. Note that both the sum and the average of these new numbers are now zero. Also, the sum of positive values is equal to the sum of negative values.  
å› æ­¤ï¼Œæˆ‘ä»¬å–å•å…ƒæ ¼ D12 ä¸­æ•°å­—çš„å¹³å‡å€¼ï¼Œå¹¶ä»æ¯åªè‚¡ç¥¨ä¸­å‡å»è¯¥å¹³å‡å€¼ã€‚è¿™ç»™æˆ‘ä»¬å¸¦æ¥äº† F åˆ—çš„æ–°å‘é‡ã€‚è¯·æ³¨æ„ï¼Œè¿™äº›æ–°æ•°å­—çš„æ€»å’Œå’Œå¹³å‡å€¼ç°åœ¨éƒ½ä¸ºé›¶ã€‚æ­¤å¤–ï¼Œæ­£å€¼çš„æ€»å’Œç­‰äºè´Ÿå€¼çš„æ€»å’Œã€‚

**_Step 3:_**Â _The resulting values are scaled or â€˜normalizedâ€™ such that absolute sum of the Alpha vector values is 1. These values can be called as normalized weights._  
æ­¥éª¤ 3ï¼šæ‰€å¾—å€¼è¢«ç¼©æ”¾æˆ–â€œæ ‡å‡†åŒ–â€ï¼Œä½¿å¾— Alpha å‘é‡å€¼çš„ç»å¯¹å’Œä¸º 1ã€‚è¿™äº›å€¼å¯ä»¥ç§°ä¸ºæ ‡å‡†åŒ–æƒé‡ã€‚

![6 table.png](https://api.worldquantbrain.com/content/images/MAMy_pb98V3wa96cybcwjrmnOEM=/252/original/6_table.png)

That means, we sum the absolute values of each row and find the sum, which is 2.3. Then we divide each row by this sum, which results in normalized values. By normalize, we mean that the total absolute sum of Column H is 1. We can also call this vector a normalized vector of weights.  
è¿™æ„å‘³ç€ï¼Œæˆ‘ä»¬å°†æ¯ä¸€è¡Œçš„ç»å¯¹å€¼ç›¸åŠ å¹¶æ±‚å’Œï¼Œå¾—åˆ° 2.3ã€‚ç„¶åæˆ‘ä»¬å°†æ¯ä¸€è¡Œé™¤ä»¥è¿™ä¸ªå’Œï¼Œå¾—åˆ°å½’ä¸€åŒ–å€¼ã€‚é€šè¿‡å½’ä¸€åŒ–ï¼Œæˆ‘ä»¬æŒ‡çš„æ˜¯åˆ— H çš„ç»å¯¹å€¼æ€»å’Œä¸º 1ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥ç§°è¿™ä¸ªå‘é‡ä¸ºæƒé‡å½’ä¸€åŒ–å‘é‡ã€‚

Note: On each iteration/day, the expression rank(-returns) will have access to all the data for returns up to that day, and the matrix will grow by one line every day until it reaches the most recent date. The role of the expression is to transform the input matrix to an output vector of weights as we see in this hypothetical example.  
æ³¨æ„ï¼šåœ¨æ¯æ¬¡è¿­ä»£/æ¯å¤©ï¼Œè¡¨è¾¾å¼ rank(-returns)å°†èƒ½å¤Ÿè·å–æˆªè‡³å½“å¤©çš„æ‰€æœ‰å›æŠ¥æ•°æ®ï¼ŒçŸ©é˜µæ¯å¤©ä¼šæ–°å¢ä¸€è¡Œï¼Œç›´åˆ°è¾¾åˆ°æœ€æ–°æ—¥æœŸã€‚è¯¥è¡¨è¾¾å¼çš„åŠŸèƒ½æ˜¯å°†è¾“å…¥çŸ©é˜µè½¬æ¢ä¸ºè¾“å‡ºæƒé‡å‘é‡ï¼Œæ­£å¦‚åœ¨è¿™ä¸ªå‡è®¾ç¤ºä¾‹ä¸­æ‰€çœ‹åˆ°çš„ã€‚

**_Step 4:_**Â _Using normalized weights, the BRAIN simulator allocates capital (from a fictitious book of $20 million) to each stock to construct a portfolio._  
æ­¥éª¤ 4ï¼šä½¿ç”¨æ ‡å‡†åŒ–æƒé‡ï¼ŒBRAIN æ¨¡æ‹Ÿå™¨å°†èµ„æœ¬ï¼ˆæ¥è‡ªä¸€ä¸ªè™šæ„çš„ 2000 ä¸‡ç¾å…ƒè´¦æˆ·ï¼‰åˆ†é…ç»™æ¯åªè‚¡ç¥¨ï¼Œä»¥æ„å»ºæŠ•èµ„ç»„åˆã€‚

![7 table.png](https://api.worldquantbrain.com/content/images/0zjHFMsINZDVlpwLEVA_skZ2-es=/253/original/7_table.png)

> [!NOTE]
> Column J has a total of $20 million of fictional money allocated to the stocks, using the normalized weights in Column H. This means we have a position of minus $4.4 million in Stock 1 â€” that is, weâ€™ve shorted $4.4 million worth of Stock 1 â€” and a long position of $0.6 million in Stock 5. That is, weâ€™ve invested $0.6 million in Stock 5.  
> åˆ— J æ€»å…±åˆ†é…äº† 2000 ä¸‡ç¾å…ƒçš„è™šæ‹Ÿèµ„é‡‘ç»™è‚¡ç¥¨ï¼Œä½¿ç”¨åˆ— H ä¸­çš„æ ‡å‡†åŒ–æƒé‡ã€‚è¿™æ„å‘³ç€æˆ‘ä»¬åœ¨è‚¡ç¥¨ 1 ä¸Šçš„å¤´å¯¸ä¸º-440 ä¸‡ç¾å…ƒâ€”â€”ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬åšç©ºäº†ä»·å€¼ 440 ä¸‡ç¾å…ƒçš„è‚¡ç¥¨ 1â€”â€”è€Œåœ¨è‚¡ç¥¨ 5 ä¸Šçš„å¤šå¤´å¤´å¯¸ä¸º 60 ä¸‡ç¾å…ƒã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬åœ¨è‚¡ç¥¨ 5 ä¸ŠæŠ•èµ„äº† 60 ä¸‡ç¾å…ƒã€‚
> 
> This is called long-short market neutralization, and itâ€™s the backbone of creating these predictive models, or Alphas, on BRAIN. With this technique, a strategy can have the potential to be profitable regardless of the direction of the market.  
> è¿™è¢«ç§°ä¸ºå¤šç©ºå¸‚åœºä¸­æ€§åŒ–ï¼Œå®ƒæ˜¯åˆ›å»º BRAIN ä¸Šçš„è¿™äº›é¢„æµ‹æ¨¡å‹æˆ– Alpha çš„æ ¸å¿ƒã€‚ä½¿ç”¨è¿™ç§æŠ€æœ¯ï¼Œç­–ç•¥æ— è®ºå¸‚åœºæœå“ªä¸ªæ–¹å‘èµ°éƒ½æœ‰å¯èƒ½ç›ˆåˆ©ã€‚
> 

**_Step 5:_**Â _Calculate next day PnL generated by the Alpha based on observed stock returns the next day_  
æ­¥éª¤ 5ï¼šæ ¹æ®æ¬¡æ—¥è§‚å¯Ÿåˆ°çš„è‚¡ç¥¨å›æŠ¥è®¡ç®— Alpha äº§ç”Ÿçš„æ¬¡æ—¥ PnL

That is, after allocating dollar positions on the stocks, we calculate the PnL generated by each stock, based on the returns each stock had that day.  
ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨åˆ†é…è‚¡ç¥¨çš„èµ„é‡‘å¤´å¯¸åï¼Œæˆ‘ä»¬æ ¹æ®æ¯åªè‚¡ç¥¨å½“æ—¥çš„å›æŠ¥è®¡ç®—æ¯åªè‚¡ç¥¨äº§ç”Ÿçš„ PnLã€‚

![8 table.png](https://api.worldquantbrain.com/content/images/V_X2U8gzlp9lsHoc6cyieR9dRDM=/254/original/8_table.png)

Suppose the actual returns on these stocks as of February 2nd are as shown in Column K. We see that although we expected Stock 1 and Stock 2 to fall in price, they actually went up, so we had a loss, shown in Column L.  
å‡è®¾æˆªè‡³ 2 æœˆ 2 æ—¥ï¼Œè¿™äº›è‚¡ç¥¨çš„å®é™…æ”¶ç›Šå¦‚ K åˆ—æ‰€ç¤ºã€‚æˆ‘ä»¬çœ‹åˆ°ï¼Œå°½ç®¡æˆ‘ä»¬é¢„æœŸè‚¡ç¥¨ 1 å’Œè‚¡ç¥¨ 2 çš„ä»·æ ¼ä¼šä¸‹è·Œï¼Œä½†å®ƒä»¬å®é™…ä¸Šä¸Šæ¶¨äº†ï¼Œå› æ­¤æˆ‘ä»¬äºæŸäº†ï¼Œå¦‚ L åˆ—æ‰€ç¤ºã€‚

We expected Stock 6 to go up in price, but it stayed flat. So we were wrong about three stocks, but we were right about five. In total, we made a gain of $0.03 million on this day with our Alpha, calculated by adding the PnLs of all stocks in our vector. This is how the simulator calculates the PnL generated by the Alpha for any given date.  
æˆ‘ä»¬é¢„æœŸè‚¡ç¥¨ 6 çš„ä»·æ ¼ä¼šä¸Šæ¶¨ï¼Œä½†å®ƒä¿æŒä¸å˜ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯¹ä¸‰åªè‚¡ç¥¨çš„åˆ¤æ–­æ˜¯é”™è¯¯çš„ï¼Œä½†å¯¹äº”åªè‚¡ç¥¨çš„åˆ¤æ–­æ˜¯æ­£ç¡®çš„ã€‚æ€»è€Œè¨€ä¹‹ï¼Œæˆ‘ä»¬é€šè¿‡ Alpha ç­–ç•¥åœ¨è¿™ä¸€å¤©è·å¾—äº† 30 ä¸‡ç¾å…ƒçš„æ”¶ç›Šï¼Œè¿™æ˜¯é€šè¿‡å°†æˆ‘ä»¬æŠ•èµ„ç»„åˆä¸­æ‰€æœ‰è‚¡ç¥¨çš„ PnL ç›¸åŠ è®¡ç®—å¾—å‡ºçš„ã€‚è¿™å°±æ˜¯æ¨¡æ‹Ÿå™¨è®¡ç®— Alpha åœ¨ä»»ä½•ç»™å®šæ—¥æœŸäº§ç”Ÿçš„ PnL çš„æ–¹å¼ã€‚

**_Step 6:_**Â _Perform the operations in Step 1 to Step 5 for each date in a several-year history span also called the In-sample period (IS) to get daily PnL generated for each day_  
æ­¥éª¤ 6ï¼šå¯¹å‡ å¹´å†å²è·¨åº¦å†…çš„æ¯ä¸ªæ—¥æœŸï¼ˆä¹Ÿç§°ä¸ºæ ·æœ¬å†…æœŸé—´ï¼ŒISï¼‰æ‰§è¡Œæ­¥éª¤ 1 è‡³æ­¥éª¤ 5 çš„æ“ä½œï¼Œä»¥è·å–æ¯å¤©äº§ç”Ÿçš„æ¯æ—¥ PnL

> [!NOTE]
> For each day, the expression is evaluated and the values in the Alpha output vector represent the weights to allocate to each stock. Alpha weights are not how much you want to buy or sell, but a weighting position you would reach this day. These weights are multiplied by book size (total money invested in the portfolio) to get the dollar value held in each stock. For example, if the Alpha weight (afterÂ [neutralization](https://support.worldquantbrain.com/hc/en-us/articles/4902349883927-Click-here-for-a-list-of-terms-and-their-definitions#:~:text=strategy.-,Neutralization,-Neutralization)Â and scaling) for MSFT is 0.2423, then weâ€™ll have MSFT stocks with the total value 0.2423*book size.  
> å¯¹äºæ¯ä¸€å¤©ï¼Œéƒ½ä¼šè®¡ç®—è¡¨è¾¾å¼ï¼ŒAlpha è¾“å‡ºå‘é‡ä¸­çš„å€¼ä»£è¡¨åˆ†é…ç»™æ¯åªè‚¡ç¥¨çš„æƒé‡ã€‚Alpha æƒé‡å¹¶ä¸æ˜¯ä½ æƒ³ä¹°å…¥æˆ–å–å‡ºçš„æ•°é‡ï¼Œè€Œæ˜¯ä½ å½“å¤©ä¼šè¾¾åˆ°çš„æƒé‡ä½ç½®ã€‚è¿™äº›æƒé‡ä¹˜ä»¥è´¦é¢è§„æ¨¡ï¼ˆæŠ•èµ„ç»„åˆä¸­çš„æ€»èµ„é‡‘ï¼‰ä»¥è·å¾—æ¯åªè‚¡ç¥¨æŒæœ‰çš„ç¾å…ƒä»·å€¼ã€‚ä¾‹å¦‚ï¼Œå¦‚æœ Alpha æƒé‡ï¼ˆç»è¿‡ä¸­å’Œå’Œç¼©æ”¾åï¼‰å¯¹ MSFT æ˜¯ 0.2423ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°†æŒæœ‰æ€»ä»·å€¼ä¸º 0.2423*è´¦é¢è§„æ¨¡çš„ MSFT è‚¡ç¥¨ã€‚

TheÂ [weight](https://support.worldquantbrain.com/hc/en-us/articles/4902349883927-Click-here-for-a-list-of-terms-and-their-definitions#:~:text=W-,Weight,-BRAIN)Â can be negative, meaning you would take a short position on these stocks. If the value is positive, you would take a long position on these stocks, i.e. buy the stocks. AÂ [NAN](https://support.worldquantbrain.com/hc/en-us/articles/4902349883927-Click-here-for-a-list-of-terms-and-their-definitions#:~:text=N-,NaN,-NaN)Â value would mean no weight is allocated to that instrument (i.e. no money is allocated). The value of stocks you buy/sell on a particular day is determined by the difference between weights today and weights yesterday. The percentage of your portfolio traded in a day (by dollar value) is called â€˜turnoverâ€™. TheÂ [turnover](https://support.worldquantbrain.com/hc/en-us/articles/4902349883927-Click-here-for-a-list-of-terms-and-their-definitions#:~:text=details.-,Turnover,-Average)Â reported inÂ [simulation](https://support.worldquantbrain.com/hc/en-us/articles/4902349883927-Click-here-for-a-list-of-terms-and-their-definitions#:~:text=definition.-,Simulation,-Simulation)Â results is the average daily turnover over the simulation.  
æƒé‡å¯ä»¥æ˜¯è´Ÿæ•°ï¼Œè¿™æ„å‘³ç€ä½ ä¼šå¯¹è¿™äº›è‚¡ç¥¨æŒç©ºå¤´å¤´å¯¸ã€‚å¦‚æœå€¼æ˜¯æ­£æ•°ï¼Œä½ ä¼šå¯¹è¿™äº›è‚¡ç¥¨æŒå¤šå¤´å¤´å¯¸ï¼Œå³ä¹°å…¥è¿™äº›è‚¡ç¥¨ã€‚NAN å€¼è¡¨ç¤ºæ²¡æœ‰åˆ†é…æƒé‡ç»™è¯¥å·¥å…·ï¼ˆå³æ²¡æœ‰åˆ†é…èµ„é‡‘ï¼‰ã€‚ä½ åœ¨æŸä¸€å¤©ä¹°å…¥/å–å‡ºè‚¡ç¥¨çš„é‡‘é¢ç”±å½“å¤©æƒé‡å’Œå‰ä¸€å¤©æƒé‡çš„å·®å€¼å†³å®šã€‚ä½ æŠ•èµ„ç»„åˆåœ¨ä¸€å¤©å†…äº¤æ˜“çš„æ¯”ä¾‹ï¼ˆæŒ‰ç¾å…ƒä»·å€¼è®¡ç®—ï¼‰ç§°ä¸ºâ€œæ¢æ‰‹ç‡â€ã€‚æ¨¡æ‹Ÿç»“æœä¸­æŠ¥å‘Šçš„æ¢æ‰‹ç‡æ˜¯æ¨¡æ‹ŸæœŸé—´çš„å¹³å‡æ—¥æ¢æ‰‹ç‡ã€‚

**_Step 7:_**Â _Calculate the cumulative PnL of the Alpha from the start of the in-sample period to get the PnL chart of the Alpha._  
æ­¥éª¤ 7ï¼šè®¡ç®— Alpha ä»æ ·æœ¬æœŸå¼€å§‹åˆ°ç»“æŸçš„ç´¯ç§¯ PnLï¼Œä»¥è·å– Alpha çš„ PnL å›¾è¡¨ã€‚

Based on those daily positions,Â [PnL](https://support.worldquantbrain.com/hc/en-us/articles/4902349883927-Click-here-for-a-list-of-terms-and-their-definitions#:~:text=consultants-,Profit%20and%20Loss%20\(PnL\),-Profit)Â is calculated and displayed. By default, the BRAIN platform will normalize your weights (according to the operations you enter) and create a portfolio of $20 million (totalÂ [booksize](https://support.worldquantbrain.com/hc/en-us/articles/4902349883927-Click-here-for-a-list-of-terms-and-their-definitions#:~:text=details.-,Booksize,-Booksize)) worth of equity. (Note that a portfolio is just a collection of securities.)  
åŸºäºè¿™äº›æ¯æ—¥å¤´å¯¸ï¼Œè®¡ç®—å¹¶æ˜¾ç¤º PnLã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒBRAIN å¹³å°å°†æ ¹æ®æ‚¨è¾“å…¥çš„æ“ä½œå¯¹æƒé‡è¿›è¡Œæ ‡å‡†åŒ–ï¼Œå¹¶åˆ›å»ºä¸€ä¸ªæ€»å¸‚å€¼è¾¾ 2000 ä¸‡ç¾å…ƒçš„è‚¡ç¥¨æŠ•èµ„ç»„åˆã€‚ï¼ˆæ³¨æ„ï¼šæŠ•èµ„ç»„åˆä»…æ˜¯ä¸€ç»„è¯åˆ¸çš„ç»„åˆã€‚ï¼‰

This can be better understood with the help of the PnL chart of the Alpha in our example rank(-returns)

![9 graph.png](https://api.worldquantbrain.com/content/images/DZS0EvjBfPBaNVkuezf0A4b7xt8=/255/original/9_graph.png)

In this chart, we have an IS period of five years, from February 2016 to January 2021. Using the steps from the example, the simulator would calculate the daily PnL of the Alpha and derive the cumulative PnL chart, as we see here. Note that the two years from February 2021 to January 2023 are not visible to us in the simulation window. Thatâ€™s called the out-of-sample, or the OS, period. After you submit an Alpha, several tests are run to analyze the Alphaâ€™s performance in the OS period. An Alpha that passes both the in-sample and out-of-sample tests can be said to be a robust Alpha.

This is how the BRAIN simulator creates the PnL chart from an Alpha.

In our example, weâ€™ve assumed that weâ€™re using market neutralization and Decay 0 settings. But if we used any other neutralization settings, the same operations would be performed on the Alpha.

Say we have 80 stocks in our simulation universe â€” ten industries with eight stocks each. The simulator would perform the same operations (first Step 1 to Step 5) on each of the ten groups and finally add the PnL from each group to get the daily PnL of the Alpha and create the cumulative PnL chart (Step 6 and Step 7)

However, if we introduce decay into our Alpha settings, an additional step must be performed to get the final Alpha vector.

Suppose we use a decay of 3 in our simulation settings. The final vector of weights in the Alpha would be calculated by combining todayâ€™s value with the previous dayâ€™s decayed value. In our example, we calculated the normalized weights in the Alpha as of February 2nd. Letâ€™s assume that the normalized weights of stocks in the Alpha vector on February 1st and January 31st are as shown in Columns N and O, respectively.

![10 table.png](https://api.worldquantbrain.com/content/images/RC4miaFltfYX2hKtqxeCgKLZe1M=/256/original/10_table.png)

Then the final weights in the Alpha would be calculated using the given weighted average formula:

which is implemented in Column P. Using this new derived vector, the simulator would calculate the daily PnL and consequently the cumulative PnL chart. Note that even if decay is used, more weight is assigned to the most recent values. So decay is an important factor in reducing transaction costs or turnover, as it includes information from previous days, preventing the Alpha from being reactive.

To summarize, once we input the Alpha expression and simulation settings in the BRAIN simulator, it performs the operations discussed above to take long or short positions for each financial instrument and generates the PnL chart.

[Prev: How to choose the Simulation Settings](https://platform.worldquantbrain.com/learn/documentation/create-alphas/simulation-settings)[Next: â­ Alpha Examples for Beginners](https://platform.worldquantbrain.com/learn/documentation/create-alphas/19-alpha-examples)

